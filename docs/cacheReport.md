# 캐시 리포트 
*** 
서버를 운영하다보면 수많은 유저들의 요청에 대응해야하는데 

일일이 모든 데이터를 전부 가져가게 된다면 사용자의 요청 당 감당해야하는 

DataBase 의 부하가 매우 심해질 것이다.

이를 해결하고자 똑같은 요청에 대해서 그 결과를 미리 저장해놓았다가 사용하는

캐시 전략을 해당 서버에 적용하려고 한다.




## 캐시할 대상 분석 

캐시를 사용하기 위한 첫번째 조건은 자주 사용한하는 곳에 적용해야하는 점이다.

그래야 많은 요청을 DB 서버를 조회하지 않기 때문에 DB 부하를 많이 늦출 수있다.

또한  캐시할 정보의 정확도가 그리 중요하지 않은 정보여야만 한다.

캐시할 내용은 해당 DB 서버의 내용을 그대로 반영한 것이아니라 이전에 업로드 
했었던 것을 그대로 유지하고 있는 상태이기 때문에 실시간 정보가 아닐 수밖에 없다.

그렇기 때문에 실시간으로 정확한 정보일 수록 DB 부하가 생기더라도 캐시할 수 있는 

대상에서는 제외를 시켜야한다. 

정리하자면 캐시할 대상의 기준으로는 크게 2가지 
1. 데이터 조회가 많이 일어나는 곳
2. 데이터 정확도가 그리 크지 않은 곳

으로 정리가 된다.

해당 관점에서 해당 서버에서 우선 가장 조회가 높을 것으로 예상 되는 API 으로는

* 콘서트 조회
* 콘서트 날짜 조회
* 콘서트 좌석 조회 
* 포인트 조회

4 가지 정도가 있을 것 같다.

하지만 콘서트 날짜 조회와 좌석 조회의 경우 대기열 로직과 Interceptor 에 의해
어느정도 이용자가 몰릴 이유가 없기도 하고 정합성이 꼭 맞아야만 하므로  실제 DB 데이터가 필요하다.


그렇기 때문에 

* 콘서트 조회
* 포인트 조회 

2 가지로 줄일 수 있다.


따라서 이번 서버에서 적용된 캐시 데이터는 콘서트 조회와 포인트 조회로 결정할 수 있다.


## 적용 방식

캐시를 적용하는 방식은 여러가지 이겠지만 이번 서버에서는 Redis 를 적용하여 구현할 생각이다.

Redis 는 Key-Value 방식의 자료구조도 존재하므로 자료구조를 선정해야하고 

TTL 이라는 캐시의 생명주기도 결정해야한다.


* ### 콘서트 조회

콘서트 조회의 경우
콘서트 조회의 Response 


해당 콘서트를 생성하거나 수정하는 API 가 없으므로 
단순히 콘서트에 대한 내용을 캐시하면 되므로 생명 주기의 경우 굳이 필요가 없을 것 같다. 

만약 필요하다면 수정하거나 생성하는 API 에 맞춰 업데이트 해주면 될 것같다.


* ### 포인트 조회
콘서트 조회와는 다르게 결제 API, 충전 API 가 있으므로 

해당 API 호출 할 때마다 캐시를 업데이트 해주면 좋을듯싶다.

